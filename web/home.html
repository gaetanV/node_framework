<!DOCTYPE html>
<html>
    <head>
        <title>The Hostel</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
        
            .box{
                padding:50px; 
                border:#ddd solid 1px;
                margin:20px;
            }    
        </style>
        <script src="/js/Stream.js"></script>
        <script src="/js/LongPolling.js"></script>
        <script src="/js/Ws.js"></script>
        <script src="/js/Polling.js"></script>
        
        <script src="/js/vue.js"></script>
         <script src="/js/jquery.min.js"></script>
    </head>
    <body>
        <div>
            Welcome to the hostel
        </div>
        <div id="fluxStream" ></div>
         <div id="fluxPolling" ></div>
          <div id="fluxLongPolling" ></div>
          
        <div  class="box" id="userStream"  >
              <h1>Websocket</h1>
             <h2> Sync User</h2>
            {{ user.name }} {{user.type}}
       
            <div>
                 <h2>Now Change me</h2>
                  {{pull}}
                
                  <div>
                NAME:
               <input v-model="pull.name" >
               TYPE:
               <input v-model="pull.type" >
                  </div> 
               <a href="javascript:void(0)"  v-on:click="push">-------- PUSH ME -----------</a>
                <h1>List Synch</h1>
                {{users}}
            </div>
        </div>
         
         <div class="box" id="userPool"  >
              <h1>LongPolling</h1>
             <h2> Sync User</h2>
            {{ user.name }} {{user.type}}
       
            <div>
                 <h2>Now Change me</h2>
                  {{pull}}
                
                  <div>
                NAME:
               <input v-model="pull.name" >
               TYPE:
               <input v-model="pull.type" >
                  </div> 
               <a href="javascript:void(0)"  v-on:click="push">-------- PUSH ME -----------</a>
                <h1>List Synch</h1>
                {{users}}
            </div>
        </div>
         
         
        <div  class="box" id="userPolling"  >
            <h1>Polling</h1>
            <a href="javascript:void(0)"  v-on:click="check">-------- CHECK ME -----------</a>
             <h2> Sync User</h2>
            {{ user.name }} {{user.type}}
       
            <div>
                 <h2>Now Change me</h2>
                  {{pull}}
                
                  <div>
                NAME:
               <input v-model="pull.name" >
               TYPE:
               <input v-model="pull.type" >
                  </div> 
               <a href="javascript:void(0)"  v-on:click="push">-------- PUSH ME -----------</a>
                <h1>List Synch</h1>
                {{users}}
            </div>
        </div>
         

         <script>
             function updateEntity(data){
                 $.ajax({
                    type:"GET",
                    cache: false,
                    data:data,
                    url: "http://192.168.0.11:7200/user/1",
                    xhrFields: {
                        withCredentials: true
                    },
                    crossDomain: true,
                    success: function (response, code, xhr) {

                        

                    }
                });
             }
   
              var s=new Ws("ws://192.168.0.11:8098",Stream);
              var d=new LongPolling("http://192.168.0.11:7200/event/",Stream); 
              var z=new Polling("http://192.168.0.11:7200/polling/",Stream); 
              
              
             new Vue({
                        el: '#userPolling',
                        data:{
                            user:{name:"",type:""},
                            users:[],
                            pull:{name:"",type:""},
                        },methods: {
                            
                            push: function (event) {
                                  updateEntity(this.pull);
                               //  s.push("/user/1/",{},this.pull); V0.0.5 > Web service
                            },
                            check: function (event) {
                                console.log("check");
                                 z.check();
                            }
                        },created: function () {
                               var vm=this;
                                z.watch("/user/1/",{},function(data){
                                    vm.user=JSON.parse(data);
                                });
                                z.watch("/user/",{},function(data){
                                    vm.users=JSON.parse(data);
                                });
                                z.pull("/user/1/",{},function(data){
                                     vm.pull=JSON.parse(data);
                                });
                        }
               })
              new Vue({
                        el: '#userStream',
                        data:{
                            user:{name:"",type:""},
                            users:[],
                            pull:{name:"",type:""},
                        },methods: {
                            
                            push: function (event) {
                                updateEntity(this.pull);
                                // s.push("/user/1/",{},this.pull);
                            }
                        },created: function () {
                               var vm=this;
                                s.watch("/user/1/",{},function(data){
                                    vm.user=JSON.parse(data);
                                });
                                s.watch("/user/",{},function(data){
                                    vm.users=JSON.parse(data);
                                });
                                s.pull("/user/1/",{},function(data){
                                     vm.pull=JSON.parse(data);
                                });
                        }
               })
               
               new Vue({
                        el: '#userPool',
                        data:{
                            user:{name:"",type:""},
                            users:[],
                            pull:{name:"",type:""},
                        },methods: {
                            
                            push: function (event) {
                                  updateEntity(this.pull);
                             //   s.push("/user/1/",{},this.pull);
                            }
                        },created: function () {
                               var vm=this;
                                d.watch("/user/1/",{},function(data){
                                    vm.user=JSON.parse(data);
                                });
                                d.watch("/user/",{},function(data){
                                    vm.users=JSON.parse(data);
                                });
                                d.pull("/user/1/",{},function(data){
                                     vm.pull=JSON.parse(data);
                                });
                       
                        }
               })
               
               
              z.info(function(data){
                      document.querySelector("#fluxPolling").innerHTML += "<div>" + data + "</div>";
                }); 
               
                s.info(function(data){
                      document.querySelector("#fluxStream").innerHTML += "<div>" + data + "</div>";
                }); 
               
                d.info(function(data){
                      document.querySelector("#fluxLongPolling").innerHTML += "<div>" + data + "</div>";
                }); 
                
                
        </script>
        
    </body>
</html>
